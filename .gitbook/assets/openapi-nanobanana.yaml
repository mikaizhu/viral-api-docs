openapi: 3.0.3
info:
  title: NanoBanana API
  description: "NanoBanana (gemini-2.5-flash-image) fast and efficient AI image generation model. Workflow: Create task (POST /v1/task/create) to get task_id → Poll query (GET /v1/task/query) → Get results. Text-to-image and image editing use the same endpoint, differentiated by input.image_urls parameter."
  version: 1.0.0
  contact:
    name: ViralAPI Support
    url: https://viralapi.ai/api-key

servers:
  - url: https://viralapi.ai
    description: Production server

security:
  - BearerAuth: []

tags:
  - name: NanoBanana
    description: "Model: `gemini-2.5-flash-image` — Fast generation"

paths:
  /v1/task/create:
    post:
      tags:
        - NanoBanana
      summary: NanoBanana Text to Image
      description: Create async image generation task. Returns task_id for subsequent queries.
      operationId: createTaskNanoBanana
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - model
                - task_type
                - input
              properties:
                model:
                  type: string
                  description: Model name, must be set to `gemini-2.5-flash-image`
                  enum:
                    - gemini-2.5-flash-image
                task_type:
                  type: string
                  description: Task type, must be set to `image`
                  enum:
                    - image
                input:
                  type: object
                  required:
                    - prompt
                  description: Input parameters
                  properties:
                    prompt:
                      type: string
                      description: Image generation prompt
                      minLength: 1
                      maxLength: 4096
                      example: "A serene mountain landscape at sunset with vibrant colors"
                    aspect_ratio:
                      type: string
                      description: Image aspect ratio, defaults to `auto`
                      default: "auto"
                      enum:
                        - "auto"
                        - "1:1"
                        - "2:3"
                        - "3:2"
                        - "3:4"
                        - "4:3"
                        - "4:5"
                        - "5:4"
                        - "9:16"
                        - "16:9"
                        - "21:9"
            example:
              model: gemini-2.5-flash-image
              task_type: image
              input:
                prompt: "A serene mountain landscape at sunset with vibrant colors"
                aspect_ratio: "16:9"
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTaskResponse'
              example:
                code: 200
                msg: success
                data:
                  task_id: "task_nanobanana_1765178625768"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "500":
          $ref: '#/components/responses/ServerError'
        "502":
          $ref: '#/components/responses/BadGateway'

  /v1/task/create-image-edit:
    post:
      tags:
        - NanoBanana
      summary: NanoBanana Image Edit
      description: "Create async image editing task based on reference images. Returns task_id for subsequent queries. Note: Actual API endpoint is POST /v1/task/create, switches to image editing mode by passing image_urls parameter."
      operationId: createImageEditTaskNanoBanana
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - model
                - task_type
                - input
              properties:
                model:
                  type: string
                  description: Model name, must be set to `gemini-2.5-flash-image`
                  enum:
                    - gemini-2.5-flash-image
                task_type:
                  type: string
                  description: Task type, must be set to `image`
                  enum:
                    - image
                input:
                  type: object
                  required:
                    - prompt
                    - image_urls
                  description: Input parameters
                  properties:
                    prompt:
                      type: string
                      description: Image editing prompt describing how to transform the reference image
                      minLength: 1
                      maxLength: 4096
                      example: "Transform this into a watercolor painting style"
                    image_urls:
                      type: array
                      description: Input image URL array, supports up to 10 images
                      items:
                        type: string
                        format: uri
                      minItems: 1
                      maxItems: 10
                      example:
                        - "https://example.com/input-image.jpg"
                    aspect_ratio:
                      type: string
                      description: Image aspect ratio, defaults to `auto`
                      default: "auto"
                      enum:
                        - "auto"
                        - "1:1"
                        - "2:3"
                        - "3:2"
                        - "3:4"
                        - "4:3"
                        - "4:5"
                        - "5:4"
                        - "9:16"
                        - "16:9"
                        - "21:9"
            example:
              model: gemini-2.5-flash-image
              task_type: image
              input:
                prompt: "Transform this into a watercolor painting style"
                image_urls:
                  - "https://example.com/input-image.jpg"
                aspect_ratio: "1:1"
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTaskResponse'
              example:
                code: 200
                msg: success
                data:
                  task_id: "task_nanobanana_1765178625768"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "500":
          $ref: '#/components/responses/ServerError'
        "502":
          $ref: '#/components/responses/BadGateway'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Authenticate using Bearer Token. Get API Key at https://viralapi.ai/api-key

  schemas:
    CreateTaskResponse:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: integer
          description: Business status code
          enum: [200]
          example: 200
        msg:
          type: string
          description: Status message
          example: "success"
        data:
          type: object
          required:
            - task_id
          properties:
            task_id:
              type: string
              description: Async task ID for querying task status
              example: "task_nanobanana_1765178625768"

    ErrorResponse:
      type: object
      required:
        - code
        - error
      properties:
        code:
          type: integer
          description: HTTP status code
        error:
          type: object
          required:
            - message
            - type
          properties:
            message:
              type: string
              description: Error message
            type:
              type: string
              description: Error type identifier
            param:
              type: string
              description: Parameter name that caused the error (optional)
            fallback_suggestion:
              type: string
              description: Suggested alternative (optional)

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 400
            error:
              message: "Invalid request parameters"
              type: invalid_request_error
    Unauthorized:
      description: Authentication failed — Token missing or invalid
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 401
            error:
              message: "Invalid or expired token"
              type: authentication_error
    PaymentRequired:
      description: Insufficient account balance
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 402
            error:
              message: "Insufficient account balance"
              type: payment_required
    Forbidden:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 403
            error:
              message: "Access denied for this model"
              type: permission_error
              param: model
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 404
            error:
              message: "Resource not found"
              type: not_found_error
    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 500
            error:
              message: "Internal server error, please try again later"
              type: server_error
    BadGateway:
      description: Gateway error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 502
            error:
              message: "Gateway error, server temporarily unavailable"
              type: bad_gateway
