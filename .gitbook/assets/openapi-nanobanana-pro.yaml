openapi: 3.0.3
info:
  title: NanoBanana Pro API
  description: "NanoBanana Pro (gemini-3-pro-image-preview) high-quality AI image generation model, supports 1K/2K/4K resolutions. Workflow: Create task (POST /v1/task/create) to get task_id → Poll query (GET /v1/task/query) → Get results. Text-to-image and image editing use the same endpoint, differentiated by input.image_urls parameter."
  version: 1.0.0
  contact:
    name: ViralAPI Support
    url: https://viralapi.ai/api-key

servers:
  - url: https://viralapi.ai
    description: Production server

security:
  - BearerAuth: []

tags:
  - name: NanoBanana Pro
    description: "Model: `gemini-3-pro-image-preview` — High quality generation"
  - name: Task Query
    description: Async task status query (general)

paths:
  /v1/task/create:
    post:
      tags:
        - NanoBanana Pro
      summary: NanoBanana Pro Text to Image
      description: Create async image generation task. Returns task_id for subsequent queries. Compared to NanoBanana, Pro model additionally supports image_size parameter (1K/2K/4K).
      operationId: createTaskNanoBananaPro
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - model
                - task_type
                - input
              properties:
                model:
                  type: string
                  description: Model name, must be set to `gemini-3-pro-image-preview`
                  enum:
                    - gemini-3-pro-image-preview
                task_type:
                  type: string
                  description: Task type, must be set to `image`
                  enum:
                    - image
                input:
                  type: object
                  required:
                    - prompt
                  description: Input parameters
                  properties:
                    prompt:
                      type: string
                      description: Image generation prompt
                      minLength: 1
                      maxLength: 4096
                      example: "A futuristic banana with neon lights in a cyberpunk city"
                    image_size:
                      type: string
                      description: Output image resolution, options are 1K (1024px, default), 2K (2048px), 4K (4096px)
                      default: "1K"
                      enum:
                        - "1K"
                        - "2K"
                        - "4K"
                    aspect_ratio:
                      type: string
                      description: Image aspect ratio, defaults to `auto`
                      default: "auto"
                      enum:
                        - "auto"
                        - "1:1"
                        - "2:3"
                        - "3:2"
                        - "3:4"
                        - "4:3"
                        - "4:5"
                        - "5:4"
                        - "9:16"
                        - "16:9"
                        - "21:9"
            example:
              model: gemini-3-pro-image-preview
              task_type: image
              input:
                prompt: "A futuristic banana with neon lights in a cyberpunk city"
                image_size: "2K"
                aspect_ratio: "9:16"
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTaskResponse'
              example:
                code: 200
                msg: success
                data:
                  task_id: "task_nano-banana-pro_1765178625768"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "500":
          $ref: '#/components/responses/ServerError'
        "502":
          $ref: '#/components/responses/BadGateway'

  /v1/task/create-image-edit:
    post:
      tags:
        - NanoBanana Pro
      summary: NanoBanana Pro Image Edit
      description: "Create async image editing task based on reference images. Returns task_id for subsequent queries. Note: Actual API endpoint is POST /v1/task/create, switches to image editing mode by passing image_urls parameter."
      operationId: createImageEditTaskNanoBananaPro
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - model
                - task_type
                - input
              properties:
                model:
                  type: string
                  description: Model name, must be set to `gemini-3-pro-image-preview`
                  enum:
                    - gemini-3-pro-image-preview
                task_type:
                  type: string
                  description: Task type, must be set to `image`
                  enum:
                    - image
                input:
                  type: object
                  required:
                    - prompt
                    - image_urls
                  description: Input parameters
                  properties:
                    prompt:
                      type: string
                      description: Image editing prompt describing how to transform the reference image
                      minLength: 1
                      maxLength: 4096
                      example: "Transform this into a cyberpunk style with neon lights"
                    image_urls:
                      type: array
                      description: Input image URL array, supports up to 10 images
                      items:
                        type: string
                        format: uri
                      minItems: 1
                      maxItems: 10
                      example:
                        - "https://example.com/input-image.jpg"
                    image_size:
                      type: string
                      description: Output image resolution, options are 1K (1024px, default), 2K (2048px), 4K (4096px)
                      default: "1K"
                      enum:
                        - "1K"
                        - "2K"
                        - "4K"
                    aspect_ratio:
                      type: string
                      description: Image aspect ratio, defaults to `auto`
                      default: "auto"
                      enum:
                        - "auto"
                        - "1:1"
                        - "2:3"
                        - "3:2"
                        - "3:4"
                        - "4:3"
                        - "4:5"
                        - "5:4"
                        - "9:16"
                        - "16:9"
                        - "21:9"
            example:
              model: gemini-3-pro-image-preview
              task_type: image
              input:
                prompt: "Transform this into a cyberpunk style with neon lights"
                image_urls:
                  - "https://example.com/input-image.jpg"
                image_size: "2K"
                aspect_ratio: "9:16"
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTaskResponse'
              example:
                code: 200
                msg: success
                data:
                  task_id: "task_nano-banana-pro_1765178625768"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "500":
          $ref: '#/components/responses/ServerError'
        "502":
          $ref: '#/components/responses/BadGateway'

  /v1/task/query:
    get:
      tags:
        - Task Query
      summary: Query Task Status
      description: "Query async task execution status and results by task_id. Task status flow: pending → processing → completed/failed. Recommended polling interval: 2-5 seconds. Stop polling when status is completed or failed. Image links are valid for 24 hours, download promptly."
      operationId: queryTask
      security:
        - BearerAuth: []
      parameters:
        - name: task_id
          in: query
          required: true
          description: Task ID (from `data.task_id` returned by create task endpoint)
          schema:
            type: string
          example: "task_nano-banana-pro_1765178625768"
      responses:
        "200":
          description: Query successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskStatusResponse'
              examples:
                completed:
                  summary: Task Completed
                  value:
                    create_time: 1756817821
                    complete_time: 1763088308
                    task_type: image
                    task_id: "task_nano-banana-pro_1765178625768"
                    progress: 100
                    model: "gemini-3-pro-image-preview"
                    status: completed
                    results:
                      - "https://cdn.viralapi.ai/outputs/generated-image-1.png"
                processing:
                  summary: Task Processing
                  value:
                    create_time: 1756817821
                    complete_time: 0
                    task_type: image
                    task_id: "task_nano-banana-pro_1765178625768"
                    progress: 45
                    model: "gemini-3-pro-image-preview"
                    status: processing
                    results: []
                pending:
                  summary: Task Pending
                  value:
                    create_time: 1756817821
                    complete_time: 0
                    task_type: image
                    task_id: "task_nano-banana-pro_1765178625768"
                    progress: 0
                    model: "gemini-3-pro-image-preview"
                    status: pending
                    results: []
                failed:
                  summary: Task Failed
                  value:
                    create_time: 1756817821
                    complete_time: 1763088308
                    task_type: image
                    task_id: "task_nano-banana-pro_1765178625768"
                    progress: 0
                    model: "gemini-3-pro-image-preview"
                    status: failed
                    results: []
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          description: Task not found or expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 404
                error:
                  message: "Task not found or expired"
                  type: not_found_error
                  param: task_id
        "500":
          $ref: '#/components/responses/ServerError'
        "502":
          $ref: '#/components/responses/BadGateway'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Authenticate using Bearer Token. Get API Key at https://viralapi.ai/api-key

  schemas:
    CreateTaskResponse:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: integer
          description: Business status code
          enum: [200]
          example: 200
        msg:
          type: string
          description: Status message
          example: "success"
        data:
          type: object
          required:
            - task_id
          properties:
            task_id:
              type: string
              description: Async task ID for querying task status
              example: "task_nano-banana-pro_1765178625768"

    TaskStatusResponse:
      type: object
      required:
        - create_time
        - complete_time
        - task_type
        - task_id
        - progress
        - model
        - status
        - results
      properties:
        create_time:
          type: integer
          format: int64
          description: Task creation time (Unix timestamp, seconds)
          example: 1756817821
        complete_time:
          type: integer
          format: int64
          description: Task completion time (Unix timestamp, seconds), `0` when not completed
          example: 1763088308
        task_type:
          type: string
          description: Task type
          enum: [image]
          example: "image"
        task_id:
          type: string
          description: Task ID
          example: "task_nano-banana-pro_1765178625768"
        progress:
          type: integer
          description: Task progress percentage
          minimum: 0
          maximum: 100
          example: 100
        model:
          type: string
          description: Model name used
          enum:
            - gemini-2.5-flash-image
            - gemini-3-pro-image-preview
          example: "gemini-3-pro-image-preview"
        status:
          type: string
          description: "Task status: pending (queued), processing (generating), completed (finished), failed (failed)"
          enum:
            - pending
            - processing
            - completed
            - failed
          example: "completed"
        results:
          type: array
          description: Generated image URL array. Only contains valid URLs when status is `completed`. Links are valid for 24 hours.
          items:
            type: string
            format: uri
          example:
            - "https://cdn.viralapi.ai/outputs/generated-image-1.png"

    ErrorResponse:
      type: object
      required:
        - code
        - error
      properties:
        code:
          type: integer
          description: HTTP status code
        error:
          type: object
          required:
            - message
            - type
          properties:
            message:
              type: string
              description: Error message
            type:
              type: string
              description: Error type identifier
            param:
              type: string
              description: Parameter name that caused the error (optional)
            fallback_suggestion:
              type: string
              description: Suggested alternative (optional)

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 400
            error:
              message: "Invalid request parameters"
              type: invalid_request_error
    Unauthorized:
      description: Authentication failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 401
            error:
              message: "Invalid or expired token"
              type: authentication_error
    PaymentRequired:
      description: Insufficient account balance
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 402
            error:
              message: "Insufficient account balance"
              type: payment_required
    Forbidden:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 403
            error:
              message: "Access denied for this model"
              type: permission_error
              param: model
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 404
            error:
              message: "Resource not found"
              type: not_found_error
    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 500
            error:
              message: "Internal server error, please try again later"
              type: server_error
    BadGateway:
      description: Gateway error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 502
            error:
              message: "Gateway error, server temporarily unavailable"
              type: bad_gateway
