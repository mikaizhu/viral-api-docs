openapi: 3.0.3
info:
  title: Tongyi Wanxiang Video Generation API
  description: |
    Tongyi Wanxiang Video Generation API supports Text-to-Video and Image-to-Video capabilities using an asynchronous task processing model.

    **Supported Models**:
    - `wan2.2-t2v-plus`: Text-to-Video model v2.2 (fixed 5s, no audio)
    - `wan2.2-i2v-flash`: Image-to-Video model v2.2 Flash (480P/720P, fixed 5s)
    - `wan2.2-i2v-plus`: Image-to-Video model v2.2 Plus (480P/1080P, fixed 5s)
    - `wan2.5-t2v-preview`: Text-to-Video model v2.5 (prompt enhancement, 5/10s, audio)
    - `wan2.5-i2v-preview`: Image-to-Video model v2.5 (higher quality, 5/10s, audio)

    **Workflow**: Create task (POST /v1/task/create) to get task_id → Poll status (GET /v1/task/query) → Retrieve results
  version: 1.0.0
  contact:
    name: ViralAPI Support
    url: https://viralapi.ai/api-key

servers:
  - url: https://viralapi.ai
    description: Production server

security:
  - BearerAuth: []

tags:
  - name: Tongyi Wanxiang
    description: Tongyi Wanxiang video generation models

paths:
  /v1/task/create:
    post:
      tags:
        - Tongyi Wanxiang
      summary: Create Video Generation Task
      description: |
        Create an asynchronous video generation task, returns task_id for subsequent queries.

        **Model Selection**:
        - Text-to-Video (T2V): Use `wan2.2-t2v-plus` or `wan2.5-t2v-preview`, no `img_url` required
        - Image-to-Video (I2V): Use `wan2.2-i2v-flash`, `wan2.2-i2v-plus`, or `wan2.5-i2v-preview`, `img_url` required
      operationId: createTongyiWanxiangTask
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - model
                - task_type
                - input
              properties:
                model:
                  type: string
                  description: |
                    Model name, supported options:
                    - `wan2.2-t2v-plus`: Text-to-Video v2.2 (fixed 5s, no audio)
                    - `wan2.2-i2v-flash`: Image-to-Video v2.2 Flash (480P/720P, fixed 5s)
                    - `wan2.2-i2v-plus`: Image-to-Video v2.2 Plus (480P/1080P, fixed 5s)
                    - `wan2.5-t2v-preview`: Text-to-Video v2.5 (prompt enhancement, 5/10s, audio)
                    - `wan2.5-i2v-preview`: Image-to-Video v2.5 (higher quality, 5/10s, audio)
                  enum:
                    - wan2.2-t2v-plus
                    - wan2.2-i2v-flash
                    - wan2.2-i2v-plus
                    - wan2.5-t2v-preview
                    - wan2.5-i2v-preview
                task_type:
                  type: string
                  description: Task type, must be set to `video`
                  enum:
                    - video
                input:
                  type: object
                  required:
                    - prompt
                  description: Input parameters object
                  properties:
                    prompt:
                      type: string
                      description: |
                        Text prompt for video generation.
                        - wan2.2 models: Maximum 800 characters
                        - wan2.5 models: Maximum 1500 characters
                        - Text-to-Video: Describe the desired video content
                        - Image-to-Video: Describe the motion in the scene
                      minLength: 1
                      maxLength: 1500
                      example: "A serene mountain landscape at sunset with flowing clouds"
                    img_url:
                      type: string
                      format: uri
                      description: |
                        **Image-to-Video (I2V) models only**: First frame image URL or Base64 encoding
                        - Resolution: 360-2000 pixels
                        - File size: ≤10MB
                        - Format: JPG, PNG, WebP
                      example: "https://example.com/first-frame.jpg"
                    negative_prompt:
                      type: string
                      description: Negative prompt describing unwanted content, maximum 500 characters
                      maxLength: 500
                      example: "blurry, low quality"
                    size:
                      type: string
                      description: |
                        **Text-to-Video (T2V) models only**: Video resolution, defaults to `1280*720`
                      default: "1280*720"
                      enum:
                        - "1280*720"
                        - "720*1280"
                        - "1920*1080"
                        - "1080*1920"
                    resolution:
                      type: string
                      description: |
                        **Image-to-Video (I2V) models only**: Video resolution
                        - wan2.2-i2v-flash: Choose 480P or 720P, defaults to 720P
                        - wan2.2-i2v-plus: Choose 480P or 1080P, defaults to 1080P
                        - wan2.5-i2v-preview: Choose 480P, 720P, or 1080P, defaults to 1080P
                      default: "720P"
                      enum:
                        - "480P"
                        - "720P"
                        - "1080P"
                    duration:
                      type: integer
                      description: |
                        Video duration (seconds)
                        - wan2.2 models: Fixed 5 seconds, cannot be modified
                        - wan2.5 models: Choose 5 or 10 seconds, defaults to 5 seconds
                      default: 5
                      minimum: 2
                      maximum: 15
                    audio_url:
                      type: string
                      format: uri
                      description: |
                        Custom audio file URL (wan2.5 models only, wan2.2 models do not support audio)
                        - wan2.5 models generate videos with audio by default (auto-dubbing)
                        - Optional: Provide custom audio file
                        - Format: wav/mp3
                        - Duration: 3-30 seconds
                        - Size: ≤15MB
                    prompt_extend:
                      type: boolean
                      description: |
                        **wan2.5-t2v-preview only**: Enable prompt enhancement to automatically optimize prompt for better results
                      default: false
                    shot_type:
                      type: string
                      description: Shot type
                      default: "single"
                      enum:
                        - "single"
                        - "multi"
                    watermark:
                      type: boolean
                      description: Whether to add watermark
                      default: false
                    seed:
                      type: integer
                      description: Random seed for reproducible results
            examples:
              wan22_t2v:
                summary: Wan2.2 Text-to-Video
                value:
                  model: wan2.2-t2v-plus
                  task_type: video
                  input:
                    prompt: "A serene mountain landscape at sunset with flowing clouds"
                    size: "1280*720"
                    duration: 5
              wan22_i2v:
                summary: Wan2.2 Image-to-Video Flash
                value:
                  model: wan2.2-i2v-flash
                  task_type: video
                  input:
                    prompt: "Camera slowly zooms in on the mountain peak"
                    img_url: "https://example.com/first-frame.jpg"
                    resolution: "720P"
                    duration: 5
              wan25_t2v:
                summary: Wan2.5 Text-to-Video
                value:
                  model: wan2.5-t2v-preview
                  task_type: video
                  input:
                    prompt: "A futuristic city with flying cars and neon lights"
                    size: "1280*720"
                    duration: 5
                    prompt_extend: true
              wan25_i2v:
                summary: Wan2.5 Image-to-Video
                value:
                  model: wan2.5-i2v-preview
                  task_type: video
                  input:
                    prompt: "The city comes alive with movement and energy"
                    img_url: "https://example.com/city-scene.jpg"
                    resolution: "1080P"
                    duration: 5
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTaskResponse'
              example:
                code: 200
                msg: success
                data:
                  task_id: "task_tongyi_wanxiang_1765178625768"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "402":
          $ref: '#/components/responses/PaymentRequired'
        "500":
          $ref: '#/components/responses/ServerError'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Authenticate using Bearer Token.

        Get API Key: Visit [ViralAPI Console](https://viralapi.ai/api-key)

  schemas:
    CreateTaskResponse:
      type: object
      properties:
        code:
          type: integer
          description: |
            Response status code
            - **200**: Success
            - **400**: Invalid request parameters
            - **401**: Authentication failed
            - **402**: Insufficient balance
            - **500**: Server error
          enum: [200, 400, 401, 402, 500]
        msg:
          type: string
          example: success
        data:
          type: object
          properties:
            task_id:
              type: string
              description: Task ID for subsequent status queries

    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: integer
              description: Error code
            message:
              type: string
              description: Error message
            type:
              type: string
              description: Error type

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: 400
              message: "Invalid request parameters"
              type: "invalid_request_error"

    Unauthorized:
      description: Authentication failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: 401
              message: "Invalid or expired token"
              type: "authentication_error"

    PaymentRequired:
      description: Insufficient account balance
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: 402
              message: "Insufficient account balance"
              type: "payment_required"

    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: 500
              message: "Internal server error"
              type: "server_error"
